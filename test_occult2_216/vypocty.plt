#!/usr/bin/gnuplot

h(h,m,s) = h + m/60. + s/3600.

deg = pi/180.  # rad
arcsec = deg/3600.
mas = 1.e-3*arcsec
yr = 365.25  # d
min = 1./1440.  # min
au = 1.49597870700e11  # m, from IAU 2012
R_E = 6.378173e6  # m; WGS-82 http://wiki.gis.com/wiki/index.php/Reference_ellipsoid 
R_P = 6.3567523142e6  # m; WGS-84 http://wiki.gis.com/wiki/index.php/Reference_ellipsoid

# jpl.out:

#*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
# Date__(UT)__HR:MN:SC.fff Date_________JDUT     R.A.___(ICRF)___DEC  R.A._(a-apprlx)_DEC.  Azi____(a-app)___Elev    APmag   S-brt      Illu%  Ang-diam  ObsSub-LON ObsSub-LAT  hEcl-Lon hEcl-Lat                r        rdot             delta      deldot  1-way_down_LT     S-O-T /r     S-T-O  Cnst     ObsEcLon    ObsEcLat  N.Pole-RA  N.Pole-DC
#*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
# 2015-Mar-12 01:00:00.000 2457093.541666667     11 10 28.177740 -09 01 40.35000  11 11 15.794870 -09 06 49.15573           n.a.          n.a.   11.631   5.772   99.87226  0.076009        n.a.       n.a.  171.805823  -9.114628   3.188232617085   3.2264508  2.21307851667284   2.0263770    18.40561278  166.7452 /T    4.0970   Crt  172.4332253 -13.1914967       n.a.       n.a.
# 2015-Mar-12 02:00:00.000 2457093.583333333     11 10 26.236280 -09 01 21.78767  11 11 13.853529 -09 06 30.59130           n.a.          n.a.   11.631   5.772   99.87238  0.076007        n.a.       n.a.  171.812357  -9.113553   3.188310255033   3.2260774  2.21312753806142   2.0478299    18.40602048  166.7516 /T    4.0950   Crt  172.4235894 -13.1899577       n.a.       n.a.

# utctest.out:

t1 = 2457093.542444
t  = 2457093.548370
t2 = 2457093.584111
d1 = 2.21307851667284
d2 = 2.21312753806142
ra1 = h(11,10,28.177740)/12.*pi
ra2 = h(11,10,26.236280)/12.*pi
de1 = -1.0*h(9,01,40.35000)*deg
de2 = -1.0*h(9,01,21.78767)*deg

d = d1 + (d2-d1)*(t-t1)/(t2-t1)
ra_A = ra1 + (ra2-ra1)*(t-t1)/(t2-t1)
de_A = de1 + (de2-de1)*(t-t1)/(t2-t1)
dd = (d2-d1)/(t2-t1)
dra = (ra2-ra1)/(t2-t1)
dde = (de2-de1)/(t2-t1)
pm = sqrt((dra*cos(de_A))**2 + dde**2)
pa = atan2((dra*cos(de_A)), dde)
prlx = R_E/(d*au)

print "# (216) Kleopatra:"
print "t = ", t
print "d = ", d, " au"   
print "ra = ", ra_A/pi*12, " h"   
print "de = ", de_A/deg, " deg"   
print "dd = ", dd, " au d^-1"   
print "dra = ", dra/pi*12, " h d^-1 = ", dra/(arcsec/min), " arcsec min^-1"
print "dde = ", dde/deg, " deg d^-1 = ", dde/(arcsec/min), " arcsec min^-1"
print "pm  = ", pm/deg, " deg d^-1 = ", pm/(arcsec/min), " arcsec min^-1"
print "pa  = ", pa/deg, " deg"
print "prlx = ", prlx/deg, " deg = ", prlx/mas, " mas (diurnal)"
print ""

# Gaia DR3, https://gea.esac.esa.int/archive/

t0 = 2457388.500789  # 2016.0 (TDB)
ra0 = 167.61593394932274*deg
de0 = -9.028117781521697*deg
prlx = 13.47462032906183*mas
dra_O = -142.23002224417098*mas/yr
dde_O = -100.59956848001424*mas/yr
ra_O = ra0 + (t-t0)*dra_O
de_O = de0 + (t-t0)*dde_O

print "# HIP 54599:"
print "ra0 = ", ra0/pi*12, " h"
print "de0 = ", de0/deg, " deg"
print "ra  = ", ra_O/pi*12, " h"
print "de  = ", de_O/deg, " deg"
print "dra = ", dra_O/pi*12, " h d^-1"
print "dde = ", dde_O/deg, " deg d^-1"
print "prlx = ", prlx/deg, " deg = ", prlx/mas, " mas (annual)"
print ""

# jpl_S.out:

#*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
# Date__(UT)__HR:MN:SC.fff Date_________JDUT     R.A.___(ICRF)___DEC  R.A._(a-apprlx)_DEC.  Azi____(a-app)___Elev    APmag   S-brt      Illu%  Ang-diam  ObsSub-LON ObsSub-LAT  hEcl-Lon hEcl-Lat                r        rdot             delta      deldot  1-way_down_LT     S-O-T /r     S-T-O  Cnst     ObsEcLon    ObsEcLat  N.Pole-RA  N.Pole-DC
#*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************
# 2015-Mar-12 01:00:00.000 2457093.541666667     23 26 37.802639 -03 35 56.83751  23 27 23.623704 -03 31 00.96165           n.a.          n.a.  -26.756 -10.589  100.00000  1931.906  209.454964  -7.222515       n.a.        n.a.   0.000000000000   0.0000000  0.99346959122994   0.4718335     8.26243464    0.0000 /?    0.0000   Aqr  351.1268216   0.0001226  286.13000   63.87000
# 2015-Mar-12 02:00:00.000 2457093.583333333     23 26 46.998300 -03 34 57.89932  23 27 32.818207 -03 30 01.99848           n.a.          n.a.  -26.756 -10.589  100.00000  1931.884  208.905875  -7.222037       n.a.        n.a.   0.000000000000   0.0000000  0.99348094772390   0.4720038     8.26252909    0.0000 /?    0.0000   Aqr  351.1684203   0.0001236  286.13000   63.87000

ra1 = h(23,26,37.802639)/12.*pi
ra2 = h(23,26,46.998300)/12.*pi
de1 = -1.0*h(03,35,56.83751)*deg
de2 = -1.0*h(03,34,57.89932)*deg

d = d1 + (d2-d1)*(t-t1)/(t2-t1)
ra_S = ra1 + (ra2-ra1)*(t-t1)/(t2-t1)
de_S = de1 + (de2-de1)*(t-t1)/(t2-t1)
print "# Sun:"
print "ra  = ", ra_S/pi*12, " h"
print "de  = ", de_S/deg, " deg"

print ""

print t
print 10.0
print 0.04
print 0.04
print d
print ra_A/pi*12.
print de_A/deg
print dd  
print dra/pi*12.
print dde/deg
print 128.0
print ra_O/pi*12.
print de_O/deg
print ra_S/pi*12.
print de_S/deg
print prlx/mas
print 0.0
print 0.0


